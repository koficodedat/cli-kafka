[2017-12-15 05:04:51,992] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-15 05:04:52,003] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,004] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:04:52,009] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,009] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:04:52,015] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-15 05:04:52,015] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-15 05:04:52,016] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-15 05:04:52,016] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-15 05:04:52,022] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-15 05:04:52,022] INFO [Controller 0]: Initialized controller epoch to 114 and zk version 113 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,023] INFO [Controller 0]: Controller 0 incremented epoch to 115 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,023] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:04:52,057] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:04:52,057] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:04:52,057] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-15 05:04:52,057] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-15 05:04:52,057] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:04:52,058] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-15 05:04:52,059] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:04:52,081] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,090] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,095] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,099] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,103] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,103] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,104] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 115 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,104] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-15 05:04:52,104] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,105] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-15 05:04:52,223] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-15 05:04:52,223] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:04:52,230] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:04:52,230] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-15 05:04:52,231] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-15 05:04:52,231] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-15 05:04:52,232] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:04:52,233] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-15 05:04:52,237] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,237] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,238] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,240] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,240] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,241] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,247] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,247] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,248] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,249] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,249] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,250] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:114)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,253] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,253] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:04:52,254] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:04:52,255] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:04:52,256] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:04:52,260] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-15 05:04:52,264] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:04:52,267] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:04:57,107] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-15 05:04:57,108] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-15 05:04:57,108] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-15 05:04:57,108] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,832] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-15 05:36:24,834] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,834] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:36:24,836] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:24,836] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:36:24,846] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-15 05:36:24,846] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-15 05:36:24,846] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-15 05:36:24,847] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-15 05:36:24,851] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-15 05:36:24,851] INFO [Controller 0]: Initialized controller epoch to 115 and zk version 114 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,852] INFO [Controller 0]: Controller 0 incremented epoch to 116 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,852] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:36:24,884] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:36:24,884] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:36:24,884] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-15 05:36:24,885] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-15 05:36:24,885] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-15 05:36:24,885] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-15 05:36:24,886] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-15 05:36:24,886] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,886] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:36:24,886] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:36:24,886] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-15 05:36:24,888] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:36:24,907] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:24,915] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:24,919] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:24,923] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:24,927] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:24,929] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:24,930] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 116 (kafka.controller.KafkaController)
[2017-12-15 05:36:24,930] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-15 05:36:24,930] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:24,931] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-15 05:36:25,132] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-15 05:36:25,132] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:36:25,138] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:36:25,138] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-15 05:36:25,139] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-15 05:36:25,140] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-15 05:36:25,140] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:36:25,140] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-15 05:36:25,145] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,145] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,146] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:25,149] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,149] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,150] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:25,153] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,153] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,154] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:25,156] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,156] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,157] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:115)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:25,160] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,160] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:36:25,162] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:36:25,164] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:36:25,164] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:36:25,169] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-15 05:36:25,180] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:36:25,195] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:36:29,936] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-15 05:36:29,936] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-15 05:36:29,936] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-15 05:36:29,936] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,751] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-15 05:48:34,754] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,754] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:48:34,757] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,757] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:48:34,759] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-15 05:48:34,759] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-15 05:48:34,760] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-15 05:48:34,760] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-15 05:48:34,764] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-15 05:48:34,765] INFO [Controller 0]: Initialized controller epoch to 116 and zk version 115 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,766] INFO [Controller 0]: Controller 0 incremented epoch to 117 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,766] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:48:34,838] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:48:34,838] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:48:34,838] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-15 05:48:34,839] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-15 05:48:34,839] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-15 05:48:34,839] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-15 05:48:34,842] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-15 05:48:34,842] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,842] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:48:34,842] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:48:34,842] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-15 05:48:34,843] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:48:34,852] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,870] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,878] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,889] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,896] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,896] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,896] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 117 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,896] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-15 05:48:34,896] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,897] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-15 05:48:34,903] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-15 05:48:34,904] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:48:34,911] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:48:34,911] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-15 05:48:34,913] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-15 05:48:34,914] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-15 05:48:34,914] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:48:34,914] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-15 05:48:34,925] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,925] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,926] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,934] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,934] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,935] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,942] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,942] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,944] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,947] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,947] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,948] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:116)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,952] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,952] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:48:34,954] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:48:34,956] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:48:34,956] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:48:34,962] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-15 05:48:34,973] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:48:34,980] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:48:39,907] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-15 05:48:39,908] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-15 05:48:39,909] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-15 05:48:39,909] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,137] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-15 05:55:19,143] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,143] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:55:19,146] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,146] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:55:19,150] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-15 05:55:19,150] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-15 05:55:19,151] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-15 05:55:19,151] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-15 05:55:19,155] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-15 05:55:19,156] INFO [Controller 0]: Initialized controller epoch to 117 and zk version 116 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,157] INFO [Controller 0]: Controller 0 incremented epoch to 118 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,157] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-15 05:55:19,278] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:55:19,278] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-15 05:55:19,278] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-15 05:55:19,279] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-15 05:55:19,279] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-15 05:55:19,279] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-15 05:55:19,280] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-15 05:55:19,280] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,280] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:55:19,280] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-15 05:55:19,280] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-15 05:55:19,282] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:55:19,299] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,317] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,333] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,352] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,368] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,373] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,373] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 118 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,373] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-15 05:55:19,373] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,374] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-15 05:55:19,381] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-15 05:55:19,381] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:55:19,396] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:55:19,396] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-15 05:55:19,398] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-15 05:55:19,399] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-15 05:55:19,400] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-15 05:55:19,401] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-15 05:55:19,420] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,420] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,421] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,438] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,438] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,440] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,445] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,445] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,447] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,452] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,452] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,454] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:117)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,460] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,460] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-15 05:55:19,461] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:118)) (kafka.controller.PartitionStateMachine)
[2017-12-15 05:55:19,463] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:55:19,463] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-15 05:55:19,466] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-15 05:55:19,472] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:55:19,478] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-15 05:55:24,380] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-15 05:55:24,381] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-15 05:55:24,381] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-15 05:55:24,381] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
