[2017-12-18 20:09:43,165] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,185] ERROR Controller 0 epoch 337 initiated state change for partition [topic-1-5,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:09:43,187] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,199] ERROR Controller 0 epoch 337 initiated state change for partition [topic-1-5,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:09:43,201] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,228] ERROR Controller 0 epoch 337 initiated state change for partition [topic-1-5,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:09:43,229] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,237] ERROR Controller 0 epoch 337 initiated state change for partition [topic-1-5,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:09:43,238] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,244] ERROR Controller 0 epoch 337 initiated state change for partition [topic-1-5,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:09:43,269] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:09:43,269] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:09:43,269] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:09:43,269] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:09:43,269] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 changed state of replica 0 for partition [topic-1-5,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 changed state of replica 0 for partition [topic-1-5,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 changed state of replica 0 for partition [topic-1-5,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 changed state of replica 0 for partition [topic-1-5,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 changed state of replica 0 for partition [topic-1-5,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:09:43,271] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:09:43,272] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:09:43,272] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,273] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 0 (state.change.logger)
[2017-12-18 20:09:43,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 0 (state.change.logger)
[2017-12-18 20:09:43,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 0 (state.change.logger)
[2017-12-18 20:09:43,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 0 (state.change.logger)
[2017-12-18 20:09:43,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 0 (state.change.logger)
[2017-12-18 20:09:43,281] TRACE Controller 0 epoch 337 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:09:43,282] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=336, leader=0, leaderEpoch=320, isr=[0], zkVersion=320, replicas=[0]) correlation id 1 from controller 0 epoch 337 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,282] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=336, leader=0, leaderEpoch=320, isr=[0], zkVersion=320, replicas=[0]) correlation id 1 from controller 0 epoch 337 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,282] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=336, leader=0, leaderEpoch=320, isr=[0], zkVersion=320, replicas=[0]) correlation id 1 from controller 0 epoch 337 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,282] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=336, leader=0, leaderEpoch=320, isr=[0], zkVersion=320, replicas=[0]) correlation id 1 from controller 0 epoch 337 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,283] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=336, leader=0, leaderEpoch=320, isr=[0], zkVersion=320, replicas=[0]) correlation id 1 from controller 0 epoch 337 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 337 for partition [topic-1-5,1] since its associated leader epoch 320 is old. Current leader epoch is 320 (state.change.logger)
[2017-12-18 20:09:43,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 337 for partition [topic-1-5,2] since its associated leader epoch 320 is old. Current leader epoch is 320 (state.change.logger)
[2017-12-18 20:09:43,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 337 for partition [topic-1-5,3] since its associated leader epoch 320 is old. Current leader epoch is 320 (state.change.logger)
[2017-12-18 20:09:43,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 337 for partition [topic-1-5,4] since its associated leader epoch 320 is old. Current leader epoch is 320 (state.change.logger)
[2017-12-18 20:09:43,283] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 337 for partition [topic-1-5,0] since its associated leader epoch 320 is old. Current leader epoch is 320 (state.change.logger)
[2017-12-18 20:09:43,285] TRACE Controller 0 epoch 337 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=11},{topic=topic-1-5,partition=4,error_code=11},{topic=topic-1-5,partition=1,error_code=11},{topic=topic-1-5,partition=3,error_code=11},{topic=topic-1-5,partition=0,error_code=11}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:09:43,285] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 2 (state.change.logger)
[2017-12-18 20:09:43,285] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 2 (state.change.logger)
[2017-12-18 20:09:43,285] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 2 (state.change.logger)
[2017-12-18 20:09:43,285] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 2 (state.change.logger)
[2017-12-18 20:09:43,286] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:320,ControllerEpoch:336),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 2 (state.change.logger)
[2017-12-18 20:09:43,286] TRACE Controller 0 epoch 337 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:09:43,287] TRACE Controller 0 epoch 337 elected leader 0 for Offline partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,287] TRACE Controller 0 epoch 337 changed partition [topic-1-5,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:09:43,287] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,299] TRACE Controller 0 epoch 337 elected leader 0 for Offline partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,299] TRACE Controller 0 epoch 337 changed partition [topic-1-5,3] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:09:43,299] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,304] TRACE Controller 0 epoch 337 elected leader 0 for Offline partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,304] TRACE Controller 0 epoch 337 changed partition [topic-1-5,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:09:43,304] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,308] TRACE Controller 0 epoch 337 elected leader 0 for Offline partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,308] TRACE Controller 0 epoch 337 changed partition [topic-1-5,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:09:43,308] TRACE Controller 0 epoch 337 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,311] TRACE Controller 0 epoch 337 elected leader 0 for Offline partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 changed partition [topic-1-5,4] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,312] TRACE Controller 0 epoch 337 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Controller 0 epoch 337 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,313] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,314] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 337 starting the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,314] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 337 starting the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,314] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 337 starting the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,314] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 337 starting the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,314] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 337 starting the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,316] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,4] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:09:43,316] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,1] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:09:43,316] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,2] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:09:43,316] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,3] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:09:43,316] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 337 for partition [topic-1-5,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 337 for the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 337 for the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 337 for the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 337 for the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 337 for the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:09:43,316] TRACE Controller 0 epoch 337 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=0},{topic=topic-1-5,partition=4,error_code=0},{topic=topic-1-5,partition=1,error_code=0},{topic=topic-1-5,partition=3,error_code=0},{topic=topic-1-5,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 4 (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 4 (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 4 (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 4 (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 337 with correlation id 4 (state.change.logger)
[2017-12-18 20:09:43,317] TRACE Controller 0 epoch 337 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:11:24,809] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:24,826] ERROR Controller 0 epoch 338 initiated state change for partition [topic-1-5,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:11:24,828] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:24,839] ERROR Controller 0 epoch 338 initiated state change for partition [topic-1-5,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:11:24,840] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:24,849] ERROR Controller 0 epoch 338 initiated state change for partition [topic-1-5,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:11:24,850] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:24,865] ERROR Controller 0 epoch 338 initiated state change for partition [topic-1-5,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:11:24,866] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:24,890] ERROR Controller 0 epoch 338 initiated state change for partition [topic-1-5,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:11:26,152] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:11:26,152] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:11:26,152] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:11:26,152] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:11:26,152] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:11:26,160] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 0 (state.change.logger)
[2017-12-18 20:11:26,160] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 0 (state.change.logger)
[2017-12-18 20:11:26,160] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 0 (state.change.logger)
[2017-12-18 20:11:26,160] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 0 (state.change.logger)
[2017-12-18 20:11:26,160] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 0 (state.change.logger)
[2017-12-18 20:11:26,161] TRACE Controller 0 epoch 338 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 changed state of replica 0 for partition [topic-1-5,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 changed state of replica 0 for partition [topic-1-5,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 changed state of replica 0 for partition [topic-1-5,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 changed state of replica 0 for partition [topic-1-5,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 changed state of replica 0 for partition [topic-1-5,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:11:26,163] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:11:26,164] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:11:26,165] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:11:26,165] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 1 from controller 0 epoch 338 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,166] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,166] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 1 from controller 0 epoch 338 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,167] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 1 from controller 0 epoch 338 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,167] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 1 from controller 0 epoch 338 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,168] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=337, leader=0, leaderEpoch=321, isr=[0], zkVersion=321, replicas=[0]) correlation id 1 from controller 0 epoch 338 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,168] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 338 for partition [topic-1-5,1] since its associated leader epoch 321 is old. Current leader epoch is 321 (state.change.logger)
[2017-12-18 20:11:26,169] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 338 for partition [topic-1-5,2] since its associated leader epoch 321 is old. Current leader epoch is 321 (state.change.logger)
[2017-12-18 20:11:26,169] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 338 for partition [topic-1-5,3] since its associated leader epoch 321 is old. Current leader epoch is 321 (state.change.logger)
[2017-12-18 20:11:26,169] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 338 for partition [topic-1-5,4] since its associated leader epoch 321 is old. Current leader epoch is 321 (state.change.logger)
[2017-12-18 20:11:26,170] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 338 for partition [topic-1-5,0] since its associated leader epoch 321 is old. Current leader epoch is 321 (state.change.logger)
[2017-12-18 20:11:26,170] TRACE Controller 0 epoch 338 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=11},{topic=topic-1-5,partition=4,error_code=11},{topic=topic-1-5,partition=1,error_code=11},{topic=topic-1-5,partition=3,error_code=11},{topic=topic-1-5,partition=0,error_code=11}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:11:26,171] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 2 (state.change.logger)
[2017-12-18 20:11:26,171] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 2 (state.change.logger)
[2017-12-18 20:11:26,171] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 2 (state.change.logger)
[2017-12-18 20:11:26,171] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 2 (state.change.logger)
[2017-12-18 20:11:26,173] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:321,ControllerEpoch:337),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 2 (state.change.logger)
[2017-12-18 20:11:26,173] TRACE Controller 0 epoch 338 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:11:26,179] TRACE Controller 0 epoch 338 elected leader 0 for Offline partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,179] TRACE Controller 0 epoch 338 changed partition [topic-1-5,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:11:26,180] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,192] TRACE Controller 0 epoch 338 elected leader 0 for Offline partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,192] TRACE Controller 0 epoch 338 changed partition [topic-1-5,3] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:11:26,192] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,228] TRACE Controller 0 epoch 338 elected leader 0 for Offline partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,228] TRACE Controller 0 epoch 338 changed partition [topic-1-5,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:11:26,228] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,230] TRACE Controller 0 epoch 338 elected leader 0 for Offline partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,230] TRACE Controller 0 epoch 338 changed partition [topic-1-5,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:11:26,231] TRACE Controller 0 epoch 338 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,235] TRACE Controller 0 epoch 338 elected leader 0 for Offline partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,235] TRACE Controller 0 epoch 338 changed partition [topic-1-5,4] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:11:26,235] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Controller 0 epoch 338 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 338 starting the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 338 starting the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 338 starting the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 338 starting the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,236] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 338 starting the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,237] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,4] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:11:26,237] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,1] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:11:26,238] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,2] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:11:26,238] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,3] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:11:26,238] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 338 for partition [topic-1-5,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:11:26,238] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 338 for the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:11:26,238] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 338 for the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:11:26,238] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 338 for the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:11:26,238] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 338 for the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:11:26,238] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 338 for the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Controller 0 epoch 338 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=0},{topic=topic-1-5,partition=4,error_code=0},{topic=topic-1-5,partition=1,error_code=0},{topic=topic-1-5,partition=3,error_code=0},{topic=topic-1-5,partition=0,error_code=0}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 4 (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 4 (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 4 (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 4 (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 338 with correlation id 4 (state.change.logger)
[2017-12-18 20:11:26,239] TRACE Controller 0 epoch 338 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:42:45,504] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,509] ERROR Controller 0 epoch 339 initiated state change for partition [topic-1-5,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:42:45,510] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,517] ERROR Controller 0 epoch 339 initiated state change for partition [topic-1-5,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:42:45,517] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,529] ERROR Controller 0 epoch 339 initiated state change for partition [topic-1-5,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:42:45,529] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,541] ERROR Controller 0 epoch 339 initiated state change for partition [topic-1-5,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:42:45,541] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,545] ERROR Controller 0 epoch 339 initiated state change for partition [topic-1-5,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:42:45,567] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:42:45,567] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:42:45,567] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:42:45,567] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:42:45,567] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 changed state of replica 0 for partition [topic-1-5,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 changed state of replica 0 for partition [topic-1-5,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 changed state of replica 0 for partition [topic-1-5,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 changed state of replica 0 for partition [topic-1-5,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 changed state of replica 0 for partition [topic-1-5,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,568] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:42:45,569] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,570] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 0 (state.change.logger)
[2017-12-18 20:42:45,570] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 0 (state.change.logger)
[2017-12-18 20:42:45,570] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 0 (state.change.logger)
[2017-12-18 20:42:45,570] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 0 (state.change.logger)
[2017-12-18 20:42:45,571] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 0 (state.change.logger)
[2017-12-18 20:42:45,571] TRACE Controller 0 epoch 339 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:42:45,575] TRACE Controller 0 epoch 339 elected leader 0 for Offline partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,575] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 1 from controller 0 epoch 339 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,575] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 1 from controller 0 epoch 339 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,575] TRACE Controller 0 epoch 339 changed partition [topic-1-5,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:42:45,575] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,576] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 1 from controller 0 epoch 339 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,576] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 1 from controller 0 epoch 339 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,576] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=338, leader=0, leaderEpoch=322, isr=[0], zkVersion=322, replicas=[0]) correlation id 1 from controller 0 epoch 339 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,576] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 339 for partition [topic-1-5,1] since its associated leader epoch 322 is old. Current leader epoch is 322 (state.change.logger)
[2017-12-18 20:42:45,576] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 339 for partition [topic-1-5,2] since its associated leader epoch 322 is old. Current leader epoch is 322 (state.change.logger)
[2017-12-18 20:42:45,576] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 339 for partition [topic-1-5,3] since its associated leader epoch 322 is old. Current leader epoch is 322 (state.change.logger)
[2017-12-18 20:42:45,576] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 339 for partition [topic-1-5,4] since its associated leader epoch 322 is old. Current leader epoch is 322 (state.change.logger)
[2017-12-18 20:42:45,576] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 339 for partition [topic-1-5,0] since its associated leader epoch 322 is old. Current leader epoch is 322 (state.change.logger)
[2017-12-18 20:42:45,577] TRACE Controller 0 epoch 339 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=11},{topic=topic-1-5,partition=4,error_code=11},{topic=topic-1-5,partition=1,error_code=11},{topic=topic-1-5,partition=3,error_code=11},{topic=topic-1-5,partition=0,error_code=11}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:42:45,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 2 (state.change.logger)
[2017-12-18 20:42:45,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 2 (state.change.logger)
[2017-12-18 20:42:45,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 2 (state.change.logger)
[2017-12-18 20:42:45,579] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 2 (state.change.logger)
[2017-12-18 20:42:45,580] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:322,ControllerEpoch:338),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 2 (state.change.logger)
[2017-12-18 20:42:45,580] TRACE Controller 0 epoch 339 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:42:45,581] TRACE Controller 0 epoch 339 elected leader 0 for Offline partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,581] TRACE Controller 0 epoch 339 changed partition [topic-1-5,3] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:42:45,581] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,587] TRACE Controller 0 epoch 339 elected leader 0 for Offline partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,587] TRACE Controller 0 epoch 339 changed partition [topic-1-5,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:42:45,587] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,598] TRACE Controller 0 epoch 339 elected leader 0 for Offline partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,599] TRACE Controller 0 epoch 339 changed partition [topic-1-5,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:42:45,599] TRACE Controller 0 epoch 339 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,616] TRACE Controller 0 epoch 339 elected leader 0 for Offline partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 changed partition [topic-1-5,4] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:42:45,617] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Controller 0 epoch 339 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 339 starting the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,618] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 339 starting the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 339 starting the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 339 starting the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 339 starting the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,619] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,4] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:42:45,619] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,1] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:42:45,619] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,2] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:42:45,619] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,3] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:42:45,619] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 339 for partition [topic-1-5,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 339 for the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 339 for the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 339 for the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 339 for the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 339 for the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:42:45,619] TRACE Controller 0 epoch 339 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=0},{topic=topic-1-5,partition=4,error_code=0},{topic=topic-1-5,partition=1,error_code=0},{topic=topic-1-5,partition=3,error_code=0},{topic=topic-1-5,partition=0,error_code=0}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:42:45,620] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 4 (state.change.logger)
[2017-12-18 20:42:45,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 4 (state.change.logger)
[2017-12-18 20:42:45,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 4 (state.change.logger)
[2017-12-18 20:42:45,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 4 (state.change.logger)
[2017-12-18 20:42:45,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 339 with correlation id 4 (state.change.logger)
[2017-12-18 20:42:45,621] TRACE Controller 0 epoch 339 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:46:35,202] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,213] ERROR Controller 0 epoch 340 initiated state change for partition [topic-1-5,1] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,1] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:46:35,215] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,223] ERROR Controller 0 epoch 340 initiated state change for partition [topic-1-5,3] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,3] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:46:35,225] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,235] ERROR Controller 0 epoch 340 initiated state change for partition [topic-1-5,2] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,2] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:46:35,235] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,245] ERROR Controller 0 epoch 340 initiated state change for partition [topic-1-5,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:46:35,246] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,252] ERROR Controller 0 epoch 340 initiated state change for partition [topic-1-5,4] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [topic-1-5,4] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:772)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:98)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:226)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:39)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:98)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:771)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:335)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:166)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1175)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1173)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:231)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1173)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:735)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2017-12-18 20:46:35,277] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:46:35,277] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:46:35,277] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:46:35,277] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:46:35,278] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 changed state of replica 0 for partition [topic-1-5,1] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 changed state of replica 0 for partition [topic-1-5,2] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 changed state of replica 0 for partition [topic-1-5,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 changed state of replica 0 for partition [topic-1-5,3] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 changed state of replica 0 for partition [topic-1-5,4] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:46:35,280] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:46:35,281] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,282] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 0 (state.change.logger)
[2017-12-18 20:46:35,282] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 0 (state.change.logger)
[2017-12-18 20:46:35,283] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 0 (state.change.logger)
[2017-12-18 20:46:35,284] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 0 (state.change.logger)
[2017-12-18 20:46:35,284] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 0 (state.change.logger)
[2017-12-18 20:46:35,284] TRACE Controller 0 epoch 340 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:46:35,290] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 1 from controller 0 epoch 340 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,291] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 1 from controller 0 epoch 340 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,291] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 1 from controller 0 epoch 340 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,291] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 1 from controller 0 epoch 340 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,292] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=339, leader=0, leaderEpoch=323, isr=[0], zkVersion=323, replicas=[0]) correlation id 1 from controller 0 epoch 340 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,292] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 340 for partition [topic-1-5,1] since its associated leader epoch 323 is old. Current leader epoch is 323 (state.change.logger)
[2017-12-18 20:46:35,292] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 340 for partition [topic-1-5,2] since its associated leader epoch 323 is old. Current leader epoch is 323 (state.change.logger)
[2017-12-18 20:46:35,292] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 340 for partition [topic-1-5,3] since its associated leader epoch 323 is old. Current leader epoch is 323 (state.change.logger)
[2017-12-18 20:46:35,292] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 340 for partition [topic-1-5,4] since its associated leader epoch 323 is old. Current leader epoch is 323 (state.change.logger)
[2017-12-18 20:46:35,292] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 340 for partition [topic-1-5,0] since its associated leader epoch 323 is old. Current leader epoch is 323 (state.change.logger)
[2017-12-18 20:46:35,292] TRACE Controller 0 epoch 340 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=11},{topic=topic-1-5,partition=4,error_code=11},{topic=topic-1-5,partition=1,error_code=11},{topic=topic-1-5,partition=3,error_code=11},{topic=topic-1-5,partition=0,error_code=11}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:46:35,293] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 2 (state.change.logger)
[2017-12-18 20:46:35,293] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 2 (state.change.logger)
[2017-12-18 20:46:35,293] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 2 (state.change.logger)
[2017-12-18 20:46:35,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 2 (state.change.logger)
[2017-12-18 20:46:35,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:323,ControllerEpoch:339),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 2 (state.change.logger)
[2017-12-18 20:46:35,294] TRACE Controller 0 epoch 340 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:46:35,295] TRACE Controller 0 epoch 340 elected leader 0 for Offline partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,296] TRACE Controller 0 epoch 340 changed partition [topic-1-5,1] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:46:35,296] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,305] TRACE Controller 0 epoch 340 elected leader 0 for Offline partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,305] TRACE Controller 0 epoch 340 changed partition [topic-1-5,3] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:46:35,305] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,309] TRACE Controller 0 epoch 340 elected leader 0 for Offline partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,309] TRACE Controller 0 epoch 340 changed partition [topic-1-5,2] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:46:35,309] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,318] TRACE Controller 0 epoch 340 elected leader 0 for Offline partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,319] TRACE Controller 0 epoch 340 changed partition [topic-1-5,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:46:35,320] TRACE Controller 0 epoch 340 started leader election for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,333] TRACE Controller 0 epoch 340 elected leader 0 for Offline partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,333] TRACE Controller 0 epoch 340 changed partition [topic-1-5,4] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2017-12-18 20:46:35,334] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,334] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,334] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,334] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,334] TRACE Controller 0 epoch 340 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,335] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition topic-1-5-2 (state.change.logger)
[2017-12-18 20:46:35,335] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=340, leader=0, leaderEpoch=324, isr=[0], zkVersion=324, replicas=[0]) correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,335] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=340, leader=0, leaderEpoch=324, isr=[0], zkVersion=324, replicas=[0]) correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,335] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition topic-1-5-4 (state.change.logger)
[2017-12-18 20:46:35,336] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition topic-1-5-1 (state.change.logger)
[2017-12-18 20:46:35,336] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition topic-1-5-3 (state.change.logger)
[2017-12-18 20:46:35,336] TRACE Controller 0 epoch 340 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340) to broker 0 for partition topic-1-5-0 (state.change.logger)
[2017-12-18 20:46:35,336] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=340, leader=0, leaderEpoch=324, isr=[0], zkVersion=324, replicas=[0]) correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,336] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=340, leader=0, leaderEpoch=324, isr=[0], zkVersion=324, replicas=[0]) correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,337] TRACE Broker 0 received LeaderAndIsr request PartitionState(controllerEpoch=340, leader=0, leaderEpoch=324, isr=[0], zkVersion=324, replicas=[0]) correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,337] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 340 starting the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,337] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 340 starting the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,337] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 340 starting the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,338] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 340 starting the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,338] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 340 starting the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,339] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,4] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:46:35,339] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,1] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:46:35,340] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,2] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:46:35,340] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,3] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:46:35,341] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 340 for partition [topic-1-5,0] since it is already the leader for the partition. (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 340 for the become-leader transition for partition [topic-1-5,4] (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 340 for the become-leader transition for partition [topic-1-5,1] (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 340 for the become-leader transition for partition [topic-1-5,2] (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 340 for the become-leader transition for partition [topic-1-5,3] (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 340 for the become-leader transition for partition [topic-1-5,0] (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Controller 0 epoch 340 received response {error_code=0,partitions=[{topic=topic-1-5,partition=2,error_code=0},{topic=topic-1-5,partition=4,error_code=0},{topic=topic-1-5,partition=1,error_code=0},{topic=topic-1-5,partition=3,error_code=0},{topic=topic-1-5,partition=0,error_code=0}]} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-1 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 4 (state.change.logger)
[2017-12-18 20:46:35,341] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-2 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 4 (state.change.logger)
[2017-12-18 20:46:35,342] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-3 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 4 (state.change.logger)
[2017-12-18 20:46:35,342] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-4 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 4 (state.change.logger)
[2017-12-18 20:46:35,342] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:324,ControllerEpoch:340),ReplicationFactor:1),AllReplicas:0) for partition topic-1-5-0 in response to UpdateMetadata request sent by controller 0 epoch 340 with correlation id 4 (state.change.logger)
[2017-12-18 20:46:35,342] TRACE Controller 0 epoch 340 received response {error_code=0} for a request sent to broker 10.0.0.199:9092 (id: 0 rack: null) (state.change.logger)
