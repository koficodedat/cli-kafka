[2017-12-16 01:03:52,357] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 01:03:52,365] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,365] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:03:52,370] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,370] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:03:52,377] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 01:03:52,377] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 01:03:52,377] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 01:03:52,380] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 01:03:52,387] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 01:03:52,389] INFO [Controller 0]: Initialized controller epoch to 163 and zk version 162 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,391] INFO [Controller 0]: Controller 0 incremented epoch to 164 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,392] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:03:52,470] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:03:52,470] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:03:52,470] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 01:03:52,470] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 01:03:52,470] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 01:03:52,471] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 01:03:52,471] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 01:03:52,472] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,472] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:03:52,472] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:03:52,472] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 01:03:52,474] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:03:52,487] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,506] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,523] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,535] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,547] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,550] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,550] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 164 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,550] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 01:03:52,551] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,552] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 01:03:52,558] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 01:03:52,559] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:03:52,576] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:03:52,576] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 01:03:52,581] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 01:03:52,582] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 01:03:52,586] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:03:52,586] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 01:03:52,615] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,615] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":148,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,618] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,632] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,632] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":148,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,634] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,659] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,659] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":148,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,661] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,666] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,666] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":148,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,667] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:147,ControllerEpoch:163)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,675] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,675] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":148,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:03:52,677] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:03:52,679] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:03:52,679] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:03:52,685] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 01:03:52,691] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:03:52,697] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:03:57,558] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 01:03:57,559] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 01:03:57,559] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 01:03:57,559] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,327] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 01:21:50,330] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,330] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:21:50,333] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,333] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:21:50,337] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 01:21:50,337] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 01:21:50,337] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 01:21:50,338] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 01:21:50,343] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 01:21:50,344] INFO [Controller 0]: Initialized controller epoch to 164 and zk version 163 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,345] INFO [Controller 0]: Controller 0 incremented epoch to 165 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,345] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:21:50,394] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:21:50,395] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:21:50,395] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 01:21:50,395] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 01:21:50,395] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 01:21:50,395] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 01:21:50,396] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 01:21:50,396] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,396] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:21:50,396] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:21:50,396] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 01:21:50,397] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:21:50,413] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,429] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,445] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,451] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,457] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,461] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,461] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 165 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,461] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 01:21:50,461] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,463] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 01:21:50,473] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 01:21:50,473] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:21:50,481] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:21:50,481] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 01:21:50,483] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 01:21:50,483] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 01:21:50,484] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:21:50,486] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 01:21:50,490] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,490] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":149,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,491] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,501] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,502] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":149,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,504] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,522] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,522] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":149,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,523] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,536] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,537] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":149,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,537] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:148,ControllerEpoch:164)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,542] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,542] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":149,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:21:50,543] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:21:50,546] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:21:50,546] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:21:50,550] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 01:21:50,559] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:21:50,567] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:21:55,473] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 01:21:55,474] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 01:21:55,474] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 01:21:55,474] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,314] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 01:37:42,319] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,319] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:37:42,321] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,321] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:37:42,326] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 01:37:42,327] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 01:37:42,327] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 01:37:42,327] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 01:37:42,332] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 01:37:42,334] INFO [Controller 0]: Initialized controller epoch to 165 and zk version 164 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,334] INFO [Controller 0]: Controller 0 incremented epoch to 166 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,334] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:37:42,437] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:37:42,437] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:37:42,437] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 01:37:42,437] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 01:37:42,437] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:37:42,438] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 01:37:42,439] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:37:42,443] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,455] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,464] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,468] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,474] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,475] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,476] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 166 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,476] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 01:37:42,476] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,477] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 01:37:42,704] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 01:37:42,704] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:37:42,709] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:37:42,709] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 01:37:42,710] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 01:37:42,711] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 01:37:42,712] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:37:42,712] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 01:37:42,718] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,718] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":150,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,718] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,721] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,721] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":150,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,724] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,727] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,727] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":150,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,730] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,731] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,731] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":150,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,731] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:149,ControllerEpoch:165)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,735] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,735] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":150,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:37:42,737] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:37:42,745] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:37:42,745] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:37:42,747] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 01:37:42,749] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:37:42,759] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:37:47,479] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 01:37:47,480] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 01:37:47,480] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 01:37:47,480] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,331] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 01:39:51,333] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,342] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:39:51,344] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:51,344] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:39:51,348] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 01:39:51,348] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 01:39:51,348] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 01:39:51,349] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 01:39:51,352] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 01:39:51,353] INFO [Controller 0]: Initialized controller epoch to 166 and zk version 165 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,354] INFO [Controller 0]: Controller 0 incremented epoch to 167 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,355] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 01:39:51,395] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,396] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:39:51,396] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:39:51,396] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 01:39:51,396] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:39:51,405] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:51,414] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:51,447] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:51,452] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:51,454] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:51,455] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:51,455] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 167 (kafka.controller.KafkaController)
[2017-12-16 01:39:51,455] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 01:39:51,455] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:51,456] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 01:39:53,362] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 01:39:53,362] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:39:53,367] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:39:53,367] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 01:39:53,368] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 01:39:53,369] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 01:39:53,371] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:39:53,371] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 01:39:53,376] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,376] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":151,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,377] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:53,382] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,382] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":151,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,383] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:53,386] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,386] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":151,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,387] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:53,391] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,391] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":151,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,392] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:166)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:53,396] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,396] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":151,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:39:53,397] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:39:53,398] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:39:53,398] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:39:53,402] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 01:39:53,408] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:39:53,420] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:39:56,460] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 01:39:56,461] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 01:39:56,461] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 01:39:56,461] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,203] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 01:55:03,204] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,205] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:55:03,208] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:03,209] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:55:03,214] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 01:55:03,214] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 01:55:03,214] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 01:55:03,214] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 01:55:03,220] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 01:55:03,220] INFO [Controller 0]: Initialized controller epoch to 167 and zk version 166 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,221] INFO [Controller 0]: Controller 0 incremented epoch to 168 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,221] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 01:55:03,258] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:55:03,258] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 01:55:03,258] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,259] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:55:03,260] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 01:55:03,260] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 01:55:03,261] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:55:03,272] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:03,283] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:03,316] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:03,326] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:03,332] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:03,333] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:03,333] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 168 (kafka.controller.KafkaController)
[2017-12-16 01:55:03,333] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 01:55:03,333] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:03,336] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 01:55:05,777] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 01:55:05,778] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:55:05,784] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:55:05,784] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 01:55:05,785] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 01:55:05,786] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 01:55:05,788] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 01:55:05,788] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 01:55:05,794] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,794] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":152,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,794] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:05,798] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,798] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":152,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,799] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:05,801] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,801] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":152,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,802] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:05,804] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,804] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":152,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,805] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:167)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:05,809] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,809] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":152,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 01:55:05,810] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:168)) (kafka.controller.PartitionStateMachine)
[2017-12-16 01:55:05,820] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:55:05,820] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 01:55:05,823] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 01:55:05,826] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:55:05,831] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 01:55:08,344] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 01:55:08,344] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 01:55:08,344] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 01:55:08,344] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
