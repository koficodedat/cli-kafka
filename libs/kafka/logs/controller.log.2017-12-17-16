[2017-12-17 16:04:05,572] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 16:04:05,580] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,580] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:04:05,581] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,581] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:04:05,584] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 16:04:05,584] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 16:04:05,584] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 16:04:05,584] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 16:04:05,590] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 16:04:05,591] INFO [Controller 0]: Initialized controller epoch to 260 and zk version 259 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,592] INFO [Controller 0]: Controller 0 incremented epoch to 261 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,593] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:04:05,639] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:04:05,639] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:04:05,639] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 16:04:05,640] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 16:04:05,640] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 16:04:05,640] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 16:04:05,641] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:04:05,648] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,660] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,666] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,673] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,680] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,680] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,681] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 261 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,681] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 16:04:05,681] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,682] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 16:04:05,692] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 16:04:05,693] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:04:05,699] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:04:05,699] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 16:04:05,700] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 16:04:05,702] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 16:04:05,703] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 16:04:05,704] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:04:05,712] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,712] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,713] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,715] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,715] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,716] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,719] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,719] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,720] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,722] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,722] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,723] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:260)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,725] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,725] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:04:05,727] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:04:05,730] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:04:05,730] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:04:05,734] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 16:04:05,739] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:04:05,743] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:04:10,691] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 16:04:10,691] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 16:04:10,691] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 16:04:10,691] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,607] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 16:39:02,618] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,618] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:39:02,630] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:02,630] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:39:02,681] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 16:39:02,681] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 16:39:02,681] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 16:39:02,681] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 16:39:02,692] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 16:39:02,694] INFO [Controller 0]: Initialized controller epoch to 261 and zk version 260 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,695] INFO [Controller 0]: Controller 0 incremented epoch to 262 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,695] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:39:02,731] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:39:02,731] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:39:02,731] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 16:39:02,732] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 16:39:02,732] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 16:39:02,732] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 16:39:02,733] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 16:39:02,733] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,734] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:39:02,734] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:39:02,734] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 16:39:02,734] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:39:02,740] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:02,747] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:02,751] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:02,756] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:02,760] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:02,761] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:02,761] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 262 (kafka.controller.KafkaController)
[2017-12-17 16:39:02,761] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 16:39:02,761] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:02,762] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 16:39:04,260] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 16:39:04,260] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:39:04,265] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:39:04,265] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 16:39:04,267] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 16:39:04,267] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 16:39:04,269] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 16:39:04,270] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:39:04,274] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,274] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":246,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,276] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:04,278] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,278] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":246,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,278] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:04,280] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,280] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":246,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,280] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:04,282] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,282] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":246,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,283] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:261)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:04,285] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,285] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":246,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:39:04,286] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:39:04,288] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:39:04,288] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:39:04,299] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 16:39:04,303] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:39:04,306] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:39:07,769] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 16:39:07,769] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 16:39:07,769] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 16:39:07,769] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,248] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 16:43:53,251] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,251] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:43:53,253] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:53,253] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:43:53,257] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 16:43:53,257] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 16:43:53,257] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 16:43:53,257] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 16:43:53,263] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 16:43:53,264] INFO [Controller 0]: Initialized controller epoch to 262 and zk version 261 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,265] INFO [Controller 0]: Controller 0 incremented epoch to 263 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,266] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:43:53,292] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:43:53,292] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:43:53,292] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:43:53,293] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 16:43:53,294] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:43:53,301] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:53,307] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:53,312] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:53,316] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:53,323] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:53,323] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:53,323] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 263 (kafka.controller.KafkaController)
[2017-12-17 16:43:53,323] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 16:43:53,323] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:53,325] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 16:43:54,552] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 16:43:54,553] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:43:54,559] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:43:54,559] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 16:43:54,563] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 16:43:54,563] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 16:43:54,564] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 16:43:54,565] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:43:54,572] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,572] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":247,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,575] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:54,578] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,578] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":247,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,581] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:54,584] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,584] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":247,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,586] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:54,589] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,590] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":247,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,591] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:246,ControllerEpoch:262)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:54,593] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,593] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":247,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:43:54,594] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:43:54,596] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:43:54,596] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:43:54,600] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 16:43:54,603] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:43:54,607] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:43:58,333] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 16:43:58,334] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 16:43:58,334] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 16:43:58,334] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,124] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 16:51:48,127] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,127] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:51:48,128] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,128] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:51:48,131] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 16:51:48,131] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 16:51:48,131] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 16:51:48,131] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 16:51:48,135] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 16:51:48,137] INFO [Controller 0]: Initialized controller epoch to 263 and zk version 262 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,139] INFO [Controller 0]: Controller 0 incremented epoch to 264 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,139] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:51:48,173] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:51:48,173] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:51:48,173] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 16:51:48,174] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 16:51:48,174] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 16:51:48,174] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 16:51:48,175] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 16:51:48,175] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,176] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:51:48,176] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:51:48,176] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 16:51:48,177] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:51:48,185] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,192] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,198] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,203] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,212] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,212] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,212] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 264 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,213] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 16:51:48,213] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,215] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 16:51:48,221] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 16:51:48,222] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:51:48,227] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:51:48,227] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 16:51:48,228] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 16:51:48,230] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 16:51:48,234] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:51:48,235] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 16:51:48,242] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,242] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":248,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,245] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,248] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,248] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":248,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,249] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,254] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,254] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":248,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,256] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,257] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,257] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":248,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,258] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:247,ControllerEpoch:263)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,260] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,260] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":248,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:51:48,261] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:51:48,263] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:51:48,263] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:51:48,266] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 16:51:48,269] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:51:48,272] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:51:53,219] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 16:51:53,220] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 16:51:53,220] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 16:51:53,220] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,452] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 16:56:41,454] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,454] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:56:41,455] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,455] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:56:41,459] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 16:56:41,459] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 16:56:41,459] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 16:56:41,459] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 16:56:41,467] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 16:56:41,468] INFO [Controller 0]: Initialized controller epoch to 264 and zk version 263 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,470] INFO [Controller 0]: Controller 0 incremented epoch to 265 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,470] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 16:56:41,501] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:56:41,501] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 16:56:41,501] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 16:56:41,502] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 16:56:41,502] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 16:56:41,502] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 16:56:41,503] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 16:56:41,503] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,503] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:56:41,504] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 16:56:41,504] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 16:56:41,504] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:56:41,510] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,515] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,521] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,525] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,548] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,548] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,548] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 265 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,548] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 16:56:41,549] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,550] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 16:56:41,558] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 16:56:41,558] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:56:41,562] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:56:41,562] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 16:56:41,565] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 16:56:41,566] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 16:56:41,567] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 16:56:41,567] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.234.156.220:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 16:56:41,575] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,575] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":249,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,575] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,578] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,578] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":249,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,578] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,581] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,581] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":249,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,582] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,585] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,585] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":249,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,586] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:248,ControllerEpoch:264)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,588] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,588] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":249,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 16:56:41,590] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:249,ControllerEpoch:265)) (kafka.controller.PartitionStateMachine)
[2017-12-17 16:56:41,591] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:56:41,591] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 16:56:41,594] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 16:56:41,597] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:56:41,600] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 16:56:46,552] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 16:56:46,552] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 16:56:46,553] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 16:56:46,553] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
