[2017-12-16 11:01:23,697] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 11:01:23,708] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,708] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:01:23,709] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,709] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:01:23,715] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 11:01:23,715] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 11:01:23,716] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 11:01:23,716] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 11:01:23,721] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 11:01:23,722] INFO [Controller 0]: Initialized controller epoch to 192 and zk version 191 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,723] INFO [Controller 0]: Controller 0 incremented epoch to 193 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,723] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:01:23,744] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:01:23,744] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:01:23,744] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 11:01:23,744] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 11:01:23,745] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 11:01:23,745] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 11:01:23,745] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 11:01:23,745] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,746] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:01:23,746] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:01:23,746] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 11:01:23,746] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:01:23,751] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,756] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,761] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,766] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,771] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,771] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,772] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 193 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,772] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 11:01:23,772] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,774] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 11:01:23,967] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 11:01:23,968] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:01:23,972] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:01:23,972] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 11:01:23,973] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 11:01:23,974] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 11:01:23,976] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:01:23,977] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 11:01:23,983] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,983] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":177,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,984] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,987] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,987] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":177,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,988] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,990] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,990] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":177,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,991] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,993] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,993] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":177,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,994] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,996] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,996] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":177,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:01:23,996] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:01:23,998] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:01:23,998] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:01:24,007] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 11:01:24,015] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:01:24,028] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:01:28,775] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:01:28,776] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:01:28,776] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:01:28,776] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,395] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 11:06:47,399] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,399] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:06:47,401] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:47,401] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:06:47,406] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 11:06:47,406] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 11:06:47,406] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 11:06:47,406] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 11:06:47,417] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 11:06:47,418] INFO [Controller 0]: Initialized controller epoch to 193 and zk version 192 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,418] INFO [Controller 0]: Controller 0 incremented epoch to 194 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,419] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:06:47,461] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:06:47,461] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:06:47,461] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 11:06:47,461] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 11:06:47,461] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 11:06:47,462] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 11:06:47,463] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 11:06:47,463] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,463] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:06:47,463] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:06:47,463] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 11:06:47,464] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:06:47,474] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:47,484] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:47,494] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:47,504] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:47,512] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:47,513] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:47,513] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 194 (kafka.controller.KafkaController)
[2017-12-16 11:06:47,513] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 11:06:47,513] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:47,515] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 11:06:48,545] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 11:06:48,546] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:06:48,556] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:06:48,556] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 11:06:48,557] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 11:06:48,557] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 11:06:48,559] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:06:48,559] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 11:06:48,565] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,565] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":178,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,567] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:48,571] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,571] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":178,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,573] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:48,577] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,577] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":178,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,578] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:48,581] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,581] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":178,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,583] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:48,585] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,585] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":178,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:06:48,586] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:06:48,588] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:06:48,588] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:06:48,592] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 11:06:48,599] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:06:48,605] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:06:52,521] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:06:52,522] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:06:52,522] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:06:52,522] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:11:52,516] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:11:52,516] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:11:52,516] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:11:52,516] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:16:52,514] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:16:52,514] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:16:52,514] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:16:52,514] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:21:52,521] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:21:52,521] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:21:52,521] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:21:52,521] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:26:52,514] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:26:52,514] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:26:52,514] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:26:52,514] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:31:52,520] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:31:52,520] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:31:52,520] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:31:52,520] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:36:52,518] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:36:52,518] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:36:52,518] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:36:52,518] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:41:52,514] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:41:52,514] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:41:52,514] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:41:52,514] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,780] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 11:50:58,785] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,785] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:50:58,793] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:58,793] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:50:58,796] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 11:50:58,797] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 11:50:58,797] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 11:50:58,797] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 11:50:58,802] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 11:50:58,803] INFO [Controller 0]: Initialized controller epoch to 194 and zk version 193 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,804] INFO [Controller 0]: Controller 0 incremented epoch to 195 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,805] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:50:58,882] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:50:58,882] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:50:58,882] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 11:50:58,883] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 11:50:58,883] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 11:50:58,883] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 11:50:58,884] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 11:50:58,884] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,884] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:50:58,884] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:50:58,884] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 11:50:58,885] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:50:58,896] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:58,926] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:58,936] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:58,955] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:58,966] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:58,968] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:58,968] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 195 (kafka.controller.KafkaController)
[2017-12-16 11:50:58,968] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 11:50:58,968] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:58,972] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 11:50:59,476] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 11:50:59,477] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:50:59,501] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:50:59,501] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 11:50:59,507] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 11:50:59,507] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 11:50:59,510] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 11:50:59,510] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:50:59,526] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,527] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,528] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:59,531] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,531] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,532] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:59,535] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,535] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,536] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:59,538] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,539] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,541] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:194)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:59,545] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,545] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:50:59,547] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:50:59,549] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:50:59,549] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:50:59,554] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 11:50:59,561] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:50:59,567] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:51:03,976] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:51:03,976] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:51:03,976] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:51:03,976] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,572] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-16 11:55:54,575] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,575] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:55:54,577] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:54,577] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:55:54,588] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-16 11:55:54,588] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-16 11:55:54,589] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-16 11:55:54,589] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-16 11:55:54,593] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-16 11:55:54,594] INFO [Controller 0]: Initialized controller epoch to 195 and zk version 194 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,596] INFO [Controller 0]: Controller 0 incremented epoch to 196 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,596] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-16 11:55:54,674] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:55:54,674] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-16 11:55:54,674] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-16 11:55:54,675] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-16 11:55:54,675] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-16 11:55:54,675] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-16 11:55:54,675] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-16 11:55:54,675] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,735] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:55:54,735] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-16 11:55:54,735] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-16 11:55:54,736] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:55:54,749] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:54,758] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:54,766] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:54,774] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:54,781] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:54,783] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:54,784] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 196 (kafka.controller.KafkaController)
[2017-12-16 11:55:54,784] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-16 11:55:54,784] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:54,786] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-16 11:55:56,542] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-16 11:55:56,542] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:55:56,560] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:55:56,561] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-16 11:55:56,564] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-16 11:55:56,565] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-16 11:55:56,569] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-16 11:55:56,569] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-16 11:55:56,589] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,589] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,592] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:56,597] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,597] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,598] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:56,606] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,606] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,611] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:56,615] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,615] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,616] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:195)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:56,620] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,620] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-16 11:55:56,621] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:196)) (kafka.controller.PartitionStateMachine)
[2017-12-16 11:55:56,624] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:55:56,624] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-16 11:55:56,629] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-16 11:55:56,637] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:55:56,647] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-16 11:55:59,789] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-16 11:55:59,790] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-16 11:55:59,790] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-16 11:55:59,790] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
