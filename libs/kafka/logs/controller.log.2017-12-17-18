[2017-12-17 18:00:26,451] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 18:00:26,458] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 18:00:26,458] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:00:26,459] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:26,459] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:00:26,462] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 18:00:26,462] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 18:00:26,462] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 18:00:26,463] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 18:00:26,468] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 18:00:26,469] INFO [Controller 0]: Initialized controller epoch to 266 and zk version 265 (kafka.controller.KafkaController)
[2017-12-17 18:00:26,469] INFO [Controller 0]: Controller 0 incremented epoch to 267 (kafka.controller.KafkaController)
[2017-12-17 18:00:26,470] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:00:26,542] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:00:26,542] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:00:26,542] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 18:00:26,542] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 18:00:26,542] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 18:00:26,543] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 18:00:26,544] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:00:26,563] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:26,575] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:26,586] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:26,638] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:26,662] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:26,663] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:26,664] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 267 (kafka.controller.KafkaController)
[2017-12-17 18:00:26,664] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 18:00:26,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:26,665] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 18:00:27,383] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 18:00:27,384] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:00:27,397] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:00:27,398] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 18:00:27,399] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 18:00:27,400] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 18:00:27,404] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:00:27,404] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 18:00:27,412] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,412] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":251,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,414] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:27,456] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,456] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":251,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,456] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:27,460] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,460] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":251,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,461] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:27,463] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,463] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":251,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,465] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:250,ControllerEpoch:266)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:27,466] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,466] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":251,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:00:27,468] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:00:27,470] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:00:27,470] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:00:27,473] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 18:00:27,475] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:00:27,477] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:00:31,673] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:00:31,674] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:00:31,674] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:00:31,674] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,224] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 18:08:55,228] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,228] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:08:55,231] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,231] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:08:55,237] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 18:08:55,237] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 18:08:55,237] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 18:08:55,237] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 18:08:55,244] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 18:08:55,245] INFO [Controller 0]: Initialized controller epoch to 267 and zk version 266 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,246] INFO [Controller 0]: Controller 0 incremented epoch to 268 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,246] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 18:08:55,303] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 18:08:55,304] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 18:08:55,305] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,305] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:08:55,343] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:08:55,343] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 18:08:55,347] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:08:55,360] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,373] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,383] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,395] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,403] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,403] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,405] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 268 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,405] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 18:08:55,405] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,407] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 18:08:55,419] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 18:08:55,420] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:08:55,428] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:08:55,428] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 18:08:55,474] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 18:08:55,475] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 18:08:55,477] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:08:55,477] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 18:08:55,483] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,483] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":252,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,484] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,491] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,491] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":252,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,491] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,496] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,497] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":252,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,499] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,503] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,503] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":252,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,504] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:251,ControllerEpoch:267)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,510] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,510] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":252,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:08:55,511] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:08:55,514] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:08:55,514] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:08:55,520] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 18:08:55,528] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:08:55,532] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:09:00,417] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:09:00,417] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:09:00,417] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:09:00,417] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,030] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 18:13:47,033] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,033] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:13:47,034] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:47,034] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:13:47,036] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 18:13:47,036] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 18:13:47,036] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 18:13:47,038] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 18:13:47,044] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 18:13:47,046] INFO [Controller 0]: Initialized controller epoch to 268 and zk version 267 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,057] INFO [Controller 0]: Controller 0 incremented epoch to 269 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,058] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 18:13:47,127] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 18:13:47,128] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 18:13:47,128] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,129] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:13:47,129] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:13:47,129] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 18:13:47,129] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:13:47,140] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:47,158] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:47,171] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:47,182] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:47,192] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:47,193] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:47,193] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 269 (kafka.controller.KafkaController)
[2017-12-17 18:13:47,193] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 18:13:47,193] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:47,197] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 18:13:48,490] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 18:13:48,490] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:13:48,499] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:13:48,499] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 18:13:48,501] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 18:13:48,501] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 18:13:48,503] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:13:48,506] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 18:13:48,513] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,513] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":253,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,514] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:48,516] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,516] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":253,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,517] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:48,519] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,519] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":253,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,520] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:48,522] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,522] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":253,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,523] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:252,ControllerEpoch:268)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:48,526] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,526] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":253,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:13:48,527] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:13:48,530] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:13:48,530] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:13:48,535] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 18:13:48,538] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:13:48,541] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:13:52,200] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:13:52,200] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:13:52,201] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:13:52,201] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,603] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2017-12-17 18:48:17,605] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,605] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:48:17,607] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,607] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:48:17,611] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2017-12-17 18:48:17,611] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2017-12-17 18:48:17,611] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2017-12-17 18:48:17,613] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2017-12-17 18:48:17,619] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2017-12-17 18:48:17,621] INFO [Controller 0]: Initialized controller epoch to 269 and zk version 268 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,622] INFO [Controller 0]: Controller 0 incremented epoch to 270 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,623] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2017-12-17 18:48:17,654] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:48:17,654] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2017-12-17 18:48:17,654] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2017-12-17 18:48:17,655] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2017-12-17 18:48:17,655] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2017-12-17 18:48:17,655] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2017-12-17 18:48:17,656] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2017-12-17 18:48:17,656] INFO [Controller 0]: List of topics ineligible for deletion: topic-1-5 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,657] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:48:17,657] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2017-12-17 18:48:17,657] INFO [Controller 0]: Current list of topics in the cluster: Set(topic-1-5) (kafka.controller.KafkaController)
[2017-12-17 18:48:17,657] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=topic-1-5,Partition=4,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=3,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic-1-5,Partition=2,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:48:17,663] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,1]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,675] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,3]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,687] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,2]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,691] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,696] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic-1-5,4]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,697] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([topic-1-5,1] -> OfflinePartition, [topic-1-5,3] -> OfflinePartition, [topic-1-5,2] -> OfflinePartition, [topic-1-5,0] -> OfflinePartition, [topic-1-5,4] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,698] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 270 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,698] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2017-12-17 18:48:17,698] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,700] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2017-12-17 18:48:17,713] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2017-12-17 18:48:17,714] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:48:17,720] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:48:17,720] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2017-12-17 18:48:17,721] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2017-12-17 18:48:17,722] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2017-12-17 18:48:17,725] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to 10.0.0.199:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2017-12-17 18:48:17,725] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=topic-1-5,Partition=1,Replica=0],[Topic=topic-1-5,Partition=2,Replica=0],[Topic=topic-1-5,Partition=0,Replica=0],[Topic=topic-1-5,Partition=3,Replica=0],[Topic=topic-1-5,Partition=4,Replica=0] (kafka.controller.ReplicaStateMachine)
[2017-12-17 18:48:17,734] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,1]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,734] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":254,"isr":[0]} for offline partition [topic-1-5,1] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,736] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,743] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,3]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,743] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":254,"isr":[0]} for offline partition [topic-1-5,3] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,745] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,747] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,2]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,747] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":254,"isr":[0]} for offline partition [topic-1-5,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,748] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,751] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,751] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":254,"isr":[0]} for offline partition [topic-1-5,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,751] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:253,ControllerEpoch:269)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,755] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic-1-5,4]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,755] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":254,"isr":[0]} for offline partition [topic-1-5,4] (kafka.controller.OfflinePartitionLeaderSelector)
[2017-12-17 18:48:17,756] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([topic-1-5,1] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,3] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,2] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,0] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270), [topic-1-5,4] -> (Leader:0,ISR:0,LeaderEpoch:254,ControllerEpoch:270)) (kafka.controller.PartitionStateMachine)
[2017-12-17 18:48:17,757] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic-1-5 (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:48:17,757] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2017-12-17 18:48:17,762] INFO [AddPartitionsListener on 0]: Partition modification triggered {"version":1,"partitions":{"4":[0],"1":[0],"0":[0],"2":[0],"3":[0]}} for path /brokers/topics/topic-1-5 (kafka.controller.PartitionStateMachine$PartitionModificationsListener)
[2017-12-17 18:48:17,767] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:48:17,772] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2017-12-17 18:48:22,708] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:48:22,708] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:48:22,708] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:48:22,708] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 18:53:22,706] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:53:22,706] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:53:22,706] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:53:22,706] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2017-12-17 18:58:22,706] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2017-12-17 18:58:22,706] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([topic-1-5,1] -> List(0), [topic-1-5,3] -> List(0), [topic-1-5,2] -> List(0), [topic-1-5,0] -> List(0), [topic-1-5,4] -> List(0))) (kafka.controller.KafkaController)
[2017-12-17 18:58:22,706] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2017-12-17 18:58:22,706] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
